---
import Layout from "../layouts/Layout.astro";
import Nav from "../components/Nav.astro";

const RELEASE_MADRID = "2026-05-23T13:00:00";
---

<Layout>
	<Nav />

	<main class="wrap">
		<h1>Fotos del día</h1>

		<p id="locked" class="text muted">
			Este apartado estará disponible a partir del
			<strong>23 de mayo de 2026 · 13:00 h</strong>.
		</p>

		<section id="content" hidden>
			<p class="text">
				Aquí podrás subir tus fotos y ver el álbum compartido del día.
			</p>

			<div class="ornament">•  •  •</div>

			<div class="actions">
				<a
					class="btn"
					href="TU_LINK_SUBIDA"
					target="_blank"
					rel="noopener"
				>
					Subir fotos
				</a>
				<a
					class="btn secondary"
					href="TU_LINK_ALBUM"
					target="_blank"
					rel="noopener"
				>
					Ver álbum
				</a>
			</div>

			<p class="caption">
				Gracias por compartir este día con nosotros.
			</p>
		</section>
	</main>
</Layout>

<script is:inline define:vars={{ RELEASE_MADRID }}>
	/** @returns {Date} */
	function madridNow() {
		const s = new Intl.DateTimeFormat("sv-SE", {
			timeZone: "Europe/Madrid",
			year: "numeric",
			month: "2-digit",
			day: "2-digit",
			hour: "2-digit",
			minute: "2-digit",
			second: "2-digit",
			hour12: false,
		}).format(new Date());
		return new Date(s.replace(" ", "T"));
	}

	/**
	 * @param {string} isoLocal
	 * @returns {Date}
	 */
	function madridDate(isoLocal) {
		const s = new Intl.DateTimeFormat("sv-SE", {
			timeZone: "Europe/Madrid",
			year: "numeric",
			month: "2-digit",
			day: "2-digit",
			hour: "2-digit",
			minute: "2-digit",
			second: "2-digit",
			hour12: false,
		}).format(new Date(isoLocal));
		return new Date(s.replace(" ", "T"));
	}

	const locked = document.getElementById("locked");
	const content = document.getElementById("content");

	if (locked && content) {
		const host = location.hostname;
		const isLocal =
			host === "localhost" ||
			host === "127.0.0.1" ||
			host.startsWith("192.168.") ||
			host.startsWith("10.") ||
			host.endsWith(".local");

		const now = madridNow();
		const release = madridDate(RELEASE_MADRID);

		if (isLocal || now >= release) {
			locked.hidden = true;
			content.hidden = false;
		}
	}
</script>

<style>
	.wrap {
		max-width: 900px;
		margin: 0 auto;
		padding: clamp(56px, 8vh, 96px) 16px;
		text-align: center;
		overflow-x: hidden;
	}

	h1 {
		margin: 0 0 18px;
		font-family: "Cormorant Garamond", serif;
		font-weight: 500;
		font-size: clamp(30px, 4vw, 42px);
		letter-spacing: 0.04em;
		color: #3f3a36;
	}

	.text {
		font-family: "Montserrat", sans-serif;
		font-size: 0.9rem;
		line-height: 1.7;
		color: rgba(63, 58, 54, 0.75);
		margin: 0 auto 18px;
		max-width: 640px;
	}

	.text strong {
		font-weight: 500;
		color: rgba(63, 58, 54, 0.9);
	}

	.muted {
		font-size: 0.85rem;
		letter-spacing: 0.02em;
	}

	.ornament {
		margin: 26px auto 30px;
		font-family: "Cormorant Garamond", serif;
		font-size: 1.1rem;
		letter-spacing: 0.6em;
		color: rgba(63, 58, 54, 0.35);
	}

	.actions {
		display: flex;
		gap: 14px;
		justify-content: center;
		flex-wrap: wrap;
		margin-top: 10px;
	}

	.btn {
		display: inline-block;
		padding: 12px 22px;
		border-radius: 999px;
		border: 1px solid rgba(63, 58, 54, 0.22);
		text-decoration: none;
		color: rgba(63, 58, 54, 0.9);
		font-family: "Montserrat", sans-serif;
		letter-spacing: 0.14em;
		text-transform: uppercase;
		font-size: 0.7rem;
		background: rgba(255, 255, 255, 0.6);
	}

	.btn:hover {
		background: rgba(255, 255, 255, 0.8);
	}

	.btn.secondary {
		background: transparent;
	}

	.caption {
		margin-top: 26px;
		font-family: "Montserrat", sans-serif;
		font-size: 0.65rem;
		letter-spacing: 0.18em;
		text-transform: uppercase;
		color: rgba(63, 58, 54, 0.35);
	}
</style>
